import{a as l,f as u,g as i}from"./chunk-LO7BOWZV.js";import{Y as c,ba as s,n as p,s as h,v as a}from"./chunk-BEKEJZ2R.js";var m=(()=>{let r=class r{constructor(e){this.storageService=e,this.userSubject=new p({_id:"",name:"",email:"",streak:0,loggedIn:!1})}setUser(e){let t={name:e.name,email:e.email,_id:e._id,streak:e.streak,loggedIn:e.loggedIn};this.userSubject.next(t),this.storageService.setStorage("user",t)}unsetUser(){this.userSubject.next({_id:"",name:"",email:"",streak:0,loggedIn:!1}),this.storageService.deleteStorage("user")}get userValue(){return this.userSubject.value}};r.\u0275fac=function(t){return new(t||r)(s(u))},r.\u0275prov=c({token:r,factory:r.\u0275fac,providedIn:"root"});let o=r;return o})();var f=(()=>{let r=class r{constructor(e){this.http=e}get(e,t){return this.http.get(e,t).pipe()}post(e,t,n){return this.http.post(e,t,n).pipe()}handleError(e){return e.error instanceof ErrorEvent?console.error("An error occurred:",e.error.message):console.error(`Backend returned code ${e.status}, body was: ${e.error}`),h("Something went wrong. Please try again later.")}};r.\u0275fac=function(t){return new(t||r)(s(l))},r.\u0275prov=c({token:r,factory:r.\u0275fac,providedIn:"root"});let o=r;return o})();var b=(()=>{let r=class r{constructor(e,t,n){this.storageService=e,this.http=t,this.userService=n,this.userSubject=new p({_id:"",name:"",email:"",streak:0,loggedIn:!1})}authenticateUser(e){return this.http.post(i.api.LOGIN,e).pipe(a(t=>(t.loggedIn=!0,this.userService.setUser(t),t)))}getData(){return console.error("heer"),this.http.get(i.api.GET_USER,{}).pipe(a(e=>{console.log(e);let t=this.userService.userValue;return t.streak=e.streak,this.userService.setUser(t),this.storageService.setStorage("streak",e.streak),e}))}refreshToken(){return this.http.post(i.api.REFRESH,{},{}).pipe(a(e=>{let t=e==null?void 0:e.accessToken;return console.log("nor showing acc token"),console.log(t),this.storageService.setStorage("accessToken",t),!!t}))}logout(){return this.http.post(i.api.LOGOUT,{}).pipe(a(e=>e))}createUser(e){return this.http.post("http://localhost:8080/auth/signup",e).pipe(t=>t)}setUserSensitiveData(e){this.setUser(e)}setUser(e){this.userService.setUser(e)}initUser(){let e=this.storageService.getStorage("user");e&&this.setUser(e)}getGoogleOAuthURL(){let e="https://accounts.google.com/o/oauth2/v2/auth",t={redirect_uri:i.googleOauthRedirectUrl,client_id:i.googleClientId,access_type:"offline",response_type:"code",prompt:"consent",scope:["https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/userinfo.email"].join(" ")},n=new URLSearchParams(t);console.log(`${e}?${n.toString()}`),window.location.href=`${e}?${n.toString()}`}};r.\u0275fac=function(t){return new(t||r)(s(u),s(f),s(m))},r.\u0275prov=c({token:r,factory:r.\u0275fac,providedIn:"root"});let o=r;return o})();export{m as a,b};
