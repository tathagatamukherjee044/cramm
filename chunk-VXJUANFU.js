import{a as f}from"./chunk-4TYPQ5EV.js";import{b as n}from"./chunk-FBZZWI7R.js";import{a as g,b as u}from"./chunk-SMJV5P4L.js";import{a as l}from"./chunk-2SHHKXS4.js";import{U as a,Z as i,k as p,o as h,r as c}from"./chunk-XIUA2BWT.js";var m=(()=>{let r=class r{constructor(e){this.http=e}get(e,t){return this.http.get(e,t).pipe()}post(e,t,o){return this.http.post(e,t,o).pipe()}handleError(e){return e.error instanceof ErrorEvent?console.error("An error occurred:",e.error.message):console.error(`Backend returned code ${e.status}, body was: ${e.error}`),h("Something went wrong. Please try again later.")}};r.\u0275fac=function(t){return new(t||r)(i(u))},r.\u0275prov=a({token:r,factory:r.\u0275fac,providedIn:"root"});let s=r;return s})();var E=(()=>{let r=class r{constructor(e,t,o){this.storageService=e,this.http=t,this.userService=o,this.userSubject=new p({_id:"",name:"",email:"",streak:0})}authenticateUser(e){return this.http.post(n.api.LOGIN,e).pipe(c(t=>t))}getData(){return this.http.get(n.api.GET_USER,{}).pipe(c(e=>{console.log(e);let t=this.userService.userValue;return t.streak=e.streak,this.userService.setUser(t),this.storageService.setStorage("streak",e.streak),e}))}refreshToken(){let e=new g().set("Authorization",`Bearer ${this.getRefreshToken()}`);return this.http.post(n.api.REFRESH,{},{headers:e}).pipe(c(t=>{let o=t==null?void 0:t.accessToken;return console.log("nor showing acc token"),console.log(o),this.storageService.setStorage("accessToken",o),!!o}))}createUser(e){return this.http.post("http://localhost:8080/auth/signup",e).pipe(t=>t)}getAccessToken(){return this.storageService.getStorage("accessToken")}getRefreshToken(){return this.storageService.getStorage("refreshToken")}setUserSensitiveData(e){this.storageService.setStorage("accessToken",e.accessToken),this.storageService.setStorage("refreshToken",e.refreshToken),this.setUser(e)}setUser(e){this.userService.setUser(e)}initUser(){let e=this.storageService.getStorage("user");e&&this.setUser(e)}getGoogleOAuthURL(){let e="https://accounts.google.com/o/oauth2/v2/auth",t={redirect_uri:n.googleOauthRedirectUrl,client_id:n.googleClientId,access_type:"offline",response_type:"code",prompt:"consent",scope:["https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/userinfo.email"].join(" ")},o=new URLSearchParams(t);console.log(`${e}?${o.toString()}`),window.location.href=`${e}?${o.toString()}`}};r.\u0275fac=function(t){return new(t||r)(i(l),i(m),i(f))},r.\u0275prov=a({token:r,factory:r.\u0275fac,providedIn:"root"});let s=r;return s})();export{E as a};
