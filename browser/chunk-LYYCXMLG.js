import{a as g}from"./chunk-H2KXZPOP.js";import{b as n}from"./chunk-DWC3NGBV.js";import{a as u}from"./chunk-DQRO7TOT.js";import{a as l}from"./chunk-6KXDVKNN.js";import{T as a,Y as i,l as p,p as h,s as c}from"./chunk-HMDBAE7C.js";var f=(()=>{let r=class r{constructor(e){this.http=e}get(e,t){return this.http.get(e,t).pipe()}post(e,t,s){return this.http.post(e,t,s).pipe()}handleError(e){return e.error instanceof ErrorEvent?console.error("An error occurred:",e.error.message):console.error(`Backend returned code ${e.status}, body was: ${e.error}`),h("Something went wrong. Please try again later.")}};r.\u0275fac=function(t){return new(t||r)(i(u))},r.\u0275prov=a({token:r,factory:r.\u0275fac,providedIn:"root"});let o=r;return o})();var I=(()=>{let r=class r{constructor(e,t,s){this.storageService=e,this.http=t,this.userService=s,this.userSubject=new p({_id:"",name:"",email:"",streak:0,loggedIn:!1})}authenticateUser(e){return this.http.post(n.api.LOGIN,e).pipe(c(t=>(t.loggedIn=!0,this.userService.setUser(t),t)))}getData(){return console.error("heer"),this.http.get(n.api.GET_USER,{}).pipe(c(e=>{console.log(e);let t=this.userService.userValue;return t.streak=e.streak,this.userService.setUser(t),this.storageService.setStorage("streak",e.streak),e}))}refreshToken(){return this.http.post(n.api.REFRESH,{},{}).pipe(c(e=>{let t=e==null?void 0:e.accessToken;return console.log("nor showing acc token"),console.log(t),this.storageService.setStorage("accessToken",t),!!t}))}createUser(e){return this.http.post("http://localhost:8080/auth/signup",e).pipe(t=>t)}setUserSensitiveData(e){this.setUser(e)}setUser(e){this.userService.setUser(e)}initUser(){let e=this.storageService.getStorage("user");e&&this.setUser(e)}getGoogleOAuthURL(){let e="https://accounts.google.com/o/oauth2/v2/auth",t={redirect_uri:n.googleOauthRedirectUrl,client_id:n.googleClientId,access_type:"offline",response_type:"code",prompt:"consent",scope:["https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/userinfo.email"].join(" ")},s=new URLSearchParams(t);console.log(`${e}?${s.toString()}`),window.location.href=`${e}?${s.toString()}`}};r.\u0275fac=function(t){return new(t||r)(i(l),i(f),i(g))},r.\u0275prov=a({token:r,factory:r.\u0275fac,providedIn:"root"});let o=r;return o})();export{I as a};
